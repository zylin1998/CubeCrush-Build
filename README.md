# 方塊三消
## 規則介紹
任意交換2個方塊，若平行或垂直連接至少3個同色方塊則消除全部連接的方塊，空缺部分由上方方塊遞補或生成，直到場面無判定無法連接。

## 建置地圖
方塊種類：```n = 4```
地圖尺寸：```size = 12```
### 1.特殊矩陣
為減省時間效率，率先建置一個由```Range(0, n)```且數字不相鄰的矩陣
```
Metrix1
{
  0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3,
  1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0,
  2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1,
  3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2,
  0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3,
  1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0,
  2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1,
  3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2,
  0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3,
  1, 2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0,
  2, 3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1,
  3, 0, 1, 2, 3, 0, 1, 2, 3, 0, 1, 2,
}
```
### 2.重新排列
以一般隨機取```1 ~ n²```的話會導致連續三個相同數字出現
```
Random.Range(0,9)
```
必須以分區的方式取得亂數
```
origin = { 0, 1, 2 ,3, 0, 1, 2, 3, 0, 1 ,2, 3 }

//After Random
ArrayX = { 2, 0, 1, 3, 3, 1, 2, 0, 0, 3, 2, 1 } 
ArrayY = { 0, 1, 2, 3, 1, 0, 3, 2, 2, 3, 1, 0 }

//After Multipler
ArrayX = { 2, 0, 1, 3, 7, 5, 6, 4, 8, 11, 10, 9 }
ArrayY = { 0, 1, 2, 3, 5, 4, 7, 6, 10, 11, 9, 8 }
```
## 遊戲狀態
透過點擊並拖曳地圖座標```MapOffset```放置至平行或垂直的臨近座標進行方塊交換，再將地圖座標的座標值傳入模組中檢測是否有連線
```
//將二座標對應至矩陣中進行交換回傳交換後是否成功連線並清除矩陣中的值
bool swap = CubeCrushModel.Swap(Vector2Int offset1, Vector2Int offset2)
//若交換成功就填補空缺
CubeCrushModel.FillEmpty()
```
若交換失敗則將原先交換位置的方塊回歸，若成功則對應矩陣消除並填補方塊，之後在依據填補情形檢查場上是否存在連線。
```
//檢查場上是否存在連線，若有連線則重複動作
bool checked = CubeCrushModel.CheckFilled()
//若無則盡興是否有可連線的預測
bool gameOver = CubeCrushModel.GameOver()
```
